# Browsers and How They Work

<!-- ================================================== -->

## 요약

브라우저는 사용자가 URL을 통해 웹 사이트에 접근할 수 있도록 도와주는 소프트웨어이다. 서버로부터 해당 페이지의 HTML, CSS, JavaScript와 같은 리소스를 받아 파싱하고, DOM과 CSSOM 트리를 생성한 후, 이를 통해 웹 페이지를 렌더링한다.

<!-- ================================================== -->

## 목차

1. [브라우저란?](#1-브라우저란)
2. [브라우저의 기본 구조](#2-브라우저의-기본-구조)
   - [사용자 인터페이스](#사용자-인터페이스)
   - [브라우저 엔진](#브라우저-엔진)
   - [렌더링 엔진](#렌더링-엔진)
   - [네트워킹](#네트워킹)
   - [UI 백엔드](#ui-백엔드)
   - [자바스크립트 해석기](#자바스크립트-해석기)
   - [데이터 저장소](#데이터-저장소)
3. [브라우저의 작동 원리](#3-브라우저의-작동-원리)
   - [서버로부터 데이터 요청](#서버로부터-데이터-요청)
   - [데이터 수신 및 파싱](#데이터-수신-및-파싱)
   - [렌더링과 레이아웃](#렌더링과-레이아웃)
   - [페인팅과 합성](#페인팅과-합성)

<!-- ================================================== -->

## 내용

### 1. 브라우저란?

브라우저는 사용자가 웹사이트에 접근할 수 있도록 해주는 소프트웨어이다. 사용자가 주소창에 URL을 입력하면 브라우저는 해당 웹 페이지의 데이터를 서버에서 요청하고, 받은 데이터를 해석해 웹 페이지를 출력한다. 대표적인 브라우저로는 Chrome, Firefox, Safari, Edge 등이 있다.

### 2. 브라우저의 기본 구조

#### 사용자 인터페이스 (User Interface)

사용자와 브라우저가 상호작용하는 부분으로, 주소창, 이전/다음 버튼, 북마크 바 등과 같은 UI 요소들이 포함된다.

#### 브라우저 엔진 (Browser Engine)

사용자 인터페이스와 렌더링 엔진 간의 상호작용을 관리하며, 페이지를 렌더링할 때 필요한 데이터 흐름을 제어하는 역할을 한다.

#### 렌더링 엔진 (Rendering Engine)

HTML, CSS를 파싱하여 **DOM 트리**와 **CSSOM 트리**를 생성하고, 이를 바탕으로 화면에 해당 웹 페이지를 렌더링하는 역할을 한다.

#### 네트워킹 (Networking)

주로 **HTTP/HTTPS** 프로토콜을 사용하여 서버와 통신하며, 네트워크 계층을 관리하는 역할을 한다.

#### UI 백엔드 (UI Backend)

운영 체제의 UI 요소와 상호작용하여, 버튼, 스크롤 바와 같은 기본 UI 위젯을 그리는 역할을 한다.

#### 자바스크립트 해석기 (JavaScript Interpreter)

자바스크립트 코드를 **해석**하고 **실행**하는 엔진이다. 브라우저에서 동적인 기능을 처리하며, 사용자 상호작용이나 실시간 데이터 갱신 등 자바스크립트로 구현된 동작을 수행한다. **비동기**적으로 실행되는 동작은 페이지 렌더링을 차단하지 않고, 이벤트 루프를 통해 해당 작업을 관리한다. 반면, **동기**적으로 실행되는 JavaScript는 실행이 완료될 때까지 브라우저가 다른 작업을 중단하기 때문에 렌더링을 지연시킬 수 있다.

#### 데이터 저장소 (Data Storage)

쿠키, 로컬 스토리지, 세션 스토리지 등을 사용하여 브라우저에 데이터를 저장하고, 이를 필요할 때 불러오는 역할을 한다.

### 3. 브라우저의 작동 원리

#### 서버로부터 데이터 요청

1. 클라이언트가 웹 사이트에 접속하면, 브라우저는 **DNS**를 통해 해당 URL에 대한 IP 주소를 확인한다.
2. 이후, 브라우저는 확인된 IP 주소로 **HTTP/HTTPS** 요청을 보내어 서버로부터 HTML, CSS, JS, 이미지 등 필요한 리소스를 요청한다. 서버에 요청을 보내기 전에 **브라우저 캐시**에서 리소스가 있는지 확인한다.

#### 데이터 수신 및 파싱

1. **서버로부터 HTML 파일을 받으면**, 브라우저는 이를 파싱하여 웹 페이지의 구조를 나타내는 **DOM**(Document Object Model) 트리를 생성한다.

2. HTML을 파싱하는 도중에 `<style>` 태그 또는 외부 CSS 파일을 로드하는 `<link>` 태그를 만나면, 브라우저는 DOM 트리 생성을 일시 중지하고 해당 CSS를 파싱하여 **CSSOM**(CSS Object Model)을 생성한다. CSSOM 생성이 완료된 후, 브라우저는 DOM 트리 생성을 이어서 진행한다.

3. HTML을 파싱하는 도중에 `<script>` 태그를 만나면, 브라우저는 JavaScript 파일을 다운로드하고 파싱 및 실행을 시작한다.
   - **동기적 JavaScript**: DOM 트리 생성이 일시 중지되며, 브라우저는 JavaScript 파일을 다운로드한 후 파싱 및 실행을 완료한 후에 DOM 트리 생성을 이어간다.
   - **비동기적 JavaScript**: async 또는 defer 속성이 있는 경우, 브라우저는 DOM 트리 생성을 중단하지 않고 JavaScript 파일을 비동기적으로 다운로드 및 실행하거나, DOM 트리 생성이 완료된 후에 JavaScript를 실행한다.

#### 렌더링과 레이아웃

1. 브라우저는 **DOM**과 **CSSOM** 트리 생성 작업을 마친 후, 이를 결합하여 **렌더 트리**를 생성한다. 렌더 트리는 화면에 표시할 요소만을 포함하며, 요소들의 레이아웃과 스타일이 정의된다.
2. 이후 **레이아웃** 단계를 통해 각 요소의 위치와 크기가 계산된다.

#### 페인팅과 합성

1. 레이아웃이 완료되면, **페인팅**(Painting) 작업을 통해 브라우저는 화면에 텍스트, 이미지, 색상 등을 출력한다.
2. 이후 **합성**(Compositing) 작업을 통해 각각의 요소를 별도의 레이어로 나누어 처리한다. 이를 통해 새로운 요소가 생길 시 필요한 부분만 재 렌더링될 수 있도록 하여 성능 최적화 및 빠른 화면 갱신을 가능하게 한다.
